<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ayudando a Fabiola Parte III | F√≠sica Vertical</title>

    <!-- Fuentes Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Oswald:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- MathJax v3 -->
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
            svg: { fontCache: 'global' }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        /* --- VARIABLES Y RESET --- */
        :root {
            --azul-rey: #1565C0;
            --azul-claro: #42A5F5;
            --fondo: #F5F7FA;
            --blanco: #FFFFFF;
            --texto: #37474F;
            --gris-borde: #CFD8DC;
            --font-title: 'Anton', sans-serif;
            --font-body: 'Oswald', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: var(--font-body);
            background-color: var(--fondo);
            color: var(--texto);
            line-height: 1.6;
            padding: 20px;
        }

        /* --- LAYOUT PRINCIPAL --- */
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--blanco);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            overflow: hidden;
            border: 1px solid var(--gris-borde);
        }

        header {
            background: linear-gradient(135deg, var(--azul-rey), var(--azul-claro));
            color: var(--blanco);
            padding: 30px 20px;
            text-align: center;
        }

        h1 {
            font-family: var(--font-title);
            font-size: 2.5rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 5px;
        }

        .subtitle { font-weight: 300; font-size: 1.1rem; opacity: 0.9; }

        /* --- NAVEGACI√ìN --- */
        .nav-tabs {
            display: flex;
            background: #ECEFF1;
            padding: 10px;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .tab-btn {
            font-family: var(--font-body);
            background: transparent;
            border: 2px solid transparent;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: var(--texto);
            border-radius: 25px;
            transition: all 0.3s;
        }

        .tab-btn:hover { background: rgba(0,0,0,0.05); }
        
        .tab-btn.active {
            background: var(--azul-rey);
            color: var(--blanco);
            box-shadow: 0 4px 6px rgba(21, 101, 192, 0.3);
        }

        /* --- CONTENIDO --- */
        .content-section {
            display: none;
            padding: 30px;
            animation: fadeIn 0.4s ease;
        }
        .content-section.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        h2 {
            font-family: var(--font-title);
            color: var(--azul-rey);
            border-bottom: 2px solid var(--azul-claro);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        /* --- COMPONENTES DE EJERCICIOS --- */
        .enunciado {
            background: #E3F2FD;
            border-left: 5px solid var(--azul-rey);
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 25px;
            font-weight: 400;
        }

        .step-card {
            background: var(--blanco);
            border: 1px solid var(--gris-borde);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03);
        }

        .step-title {
            font-family: var(--font-title);
            color: var(--azul-rey);
            font-size: 1.2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        .step-title::before {
            content: ''; display: inline-block; width: 8px; height: 8px;
            background: var(--azul-claro); border-radius: 50%; margin-right: 10px;
        }

        .explicacion {
            font-size: 0.95rem;
            color: #546E7A;
            background: #FAFAFA;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 10px;
            border-left: 3px solid #B0BEC5;
        }

        .formula-box {
            text-align: center;
            background: #ECEFF1;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            overflow-x: auto;
        }

        .resultado-final {
            background: linear-gradient(135deg, var(--azul-rey), var(--azul-claro));
            color: var(--blanco);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-top: 30px;
        }
        .res-valor { font-size: 1.8rem; font-weight: 700; font-family: var(--font-body); }

        /* --- CANVAS --- */
        .canvas-container {
            background: #ECEFF1;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid var(--gris-borde);
        }
        canvas {
            background: #FFF;
            border-radius: 4px;
            max-width: 100%;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
        }
        .controls { margin-top: 10px; display: flex; gap: 10px; justify-content: center; }
        .btn-small {
            padding: 5px 15px;
            font-size: 0.9rem;
            background: var(--blanco);
            border: 1px solid var(--azul-rey);
            color: var(--azul-rey);
            border-radius: 20px;
            cursor: pointer;
        }
        .btn-small:hover { background: var(--azul-rey); color: var(--blanco); }

        /* --- RESPONSIVE (‚â§ 540px) --- */
        @media (max-width: 540px) {
            body { padding: 10px; }
            h1 { font-size: 1.8rem; }
            .nav-tabs { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
            .tab-btn { width: 100%; text-align: center; padding: 8px; font-size: 0.9rem; }
            .content-section { padding: 15px; }
            canvas { height: 200px; }
            .controls { flex-direction: column; }
            .btn-small { width: 100%; }
            .res-valor { font-size: 1.5rem; }
        }

        /* Loader */
        .loader { text-align: center; padding: 20px; color: var(--azul-rey); font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>AYUDANDO A FABIOLA PARTE III</h1>
        <p class="subtitle">Movimiento Vertical y Ca√≠da Libre</p>
    </header>

    <nav class="nav-tabs">
        <button class="tab-btn active" onclick="switchTab('teoria')">Teor√≠a</button>
        <button class="tab-btn" onclick="switchTab('ej1')">Ejercicio 1</button>
        <button class="tab-btn" onclick="switchTab('ej2')">Ejercicio 2</button>
        <button class="tab-btn" onclick="switchTab('ej3')">Ejercicio 3</button>
    </nav>

    <main>
        <!-- TEOR√çA -->
        <div id="teoria" class="content-section active">
            <h2>Fundamentos Te√≥ricos</h2>
            <div class="step-card">
                <div class="step-title">1. La Gravedad ($g$)</div>
                <p>Es la aceleraci√≥n constante hacia abajo. Usaremos $g = 9.8 \, m/s^2$.</p>
            </div>
            <div class="step-card">
                <div class="step-title">2. Signos (Sistema de Referencia)</div>
                <p>üîº <strong>Arriba (+):</strong> Velocidad positiva.</p>
                <p>üîΩ <strong>Abajo (-):</strong> Velocidad negativa y Gravedad ($-g$).</p>
            </div>
            <div class="step-card">
                <div class="step-title">3. F√≥rmulas Maestras</div>
                <div class="formula-box">$$ v_f = v_0 - g t $$</div>
                <div class="formula-box">$$ y = y_0 + v_0 t - \frac{1}{2} g t^2 $$</div>
                <div class="formula-box">$$ v_f^2 = v_0^2 - 2g(y - y_0) $$</div>
            </div>
        </div>

        <!-- EJERCICIO 1 -->
        <div id="ej1" class="content-section">
            <h2>Ejercicio 1: Bateo Vertical</h2>
            <div class="enunciado">
                Un bate batea una pelota y sube durante 3 segundos. Calcula la velocidad inicial y la altura m√°xima.
            </div>
            
            <div class="canvas-container">
                <canvas id="canvas1"></canvas>
                <div class="controls">
                    <button class="btn-small" onclick="anim1.toggle()">Reproducir / Pausar</button>
                    <button class="btn-small" onclick="anim1.reset()">Reiniciar</button>
                </div>
            </div>

            <div id="solucion-ej1"></div>
        </div>

        <!-- EJERCICIO 2 -->
        <div id="ej2" class="content-section">
            <h2>Ejercicio 2: Encuentro</h2>
            <div class="enunciado">
                Desde un edificio de 800m se lanza abajo una pelota (A) a 80 m/s. Simult√°neamente, desde el suelo se lanza arriba otra (B) a 80 m/s. Calcular tiempo, altura y velocidades de cruce.
            </div>

            <div class="canvas-container">
                <canvas id="canvas2"></canvas>
                <div class="controls">
                    <button class="btn-small" onclick="anim2.toggle()">Reproducir / Pausar</button>
                    <button class="btn-small" onclick="anim2.reset()">Reiniciar</button>
                </div>
            </div>

            <div id="solucion-ej2"></div>
        </div>

        <!-- EJERCICIO 3 -->
        <div id="ej3" class="content-section">
            <h2>Ejercicio 3: El Cohete</h2>
            <div class="enunciado">
                Un cohete sube con $a=6.0 m/s^2$ por 20s. Luego apaga motores. Calcular altura a los 20s, velocidad, altura m√°xima y tiempo total.
            </div>

            <div class="canvas-container">
                <canvas id="canvas3"></canvas>
                <div class="controls">
                    <button class="btn-small" onclick="anim3.toggle()">Reproducir (x5)</button>
                    <button class="btn-small" onclick="anim3.reset()">Reiniciar</button>
                </div>
            </div>

            <div id="solucion-ej3"></div>
        </div>
    </main>
</div>

<script>
/* --- L√ìGICA GENERAL --- */
let currentTab = 'teoria';

function switchTab(tabId) {
    // UI Tabs
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');
    
    document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
    const target = document.getElementById(tabId);
    target.classList.add('active');
    
    currentTab = tabId;
    stopAllAnimations();

    // Carga diferida de contenido
    if(tabId === 'ej1') loadEj1();
    if(tabId === 'ej2') loadEj2();
    if(tabId === 'ej3') loadEj3();

    // Renderizar MathJax
    setTimeout(() => {
        if(window.MathJax) window.MathJax.typesetPromise([target]);
    }, 50);
}

function stopAllAnimations() {
    anim1.stop();
    anim2.stop();
    anim3.stop();
}

function format(num) { return Number(num).toFixed(2); }

/* --- GENERADORES DE HTML --- */
function createStep(title, content, why) {
    return `
        <div class="step-card">
            <div class="step-title">${title}</div>
            ${why ? `<div class="explicacion"><strong>¬øPor qu√©?</strong> ${why}</div>` : ''}
            <div>${content}</div>
        </div>
    `;
}

/* --- EJERCICIO 1 --- */
let ej1Loaded = false;
function loadEj1() {
    if(ej1Loaded) { anim1.init(); return; }
    
    const t = 3, g = 9.8;
    const v0 = g * t;
    const h_max = (v0 * t) - (0.5 * g * t*t);

    let html = createStep("Paso 1: Datos", 
        `$t = 3s$, $g = 9.8 m/s^2$, $v_f = 0$ (en altura m√°x).`, 
        "En el punto m√°s alto, la pelota se detiene un instante.");
    
    html += createStep("Paso 2: Velocidad Inicial", 
        `$$ v_f = v_0 - gt \\Rightarrow 0 = v_0 - (9.8)(3) $$ 
         $$ v_0 = 29.4 \\, m/s $$`, 
        "Despejamos $v_0$ sabiendo que la gravedad la fren√≥ en 3 segundos.");

    html += createStep("Paso 3: Altura M√°xima", 
        `$$ h = v_0 t - 0.5 g t^2 $$
         $$ h = (29.4)(3) - 0.5(9.8)(9) $$
         $$ h = 88.2 - 44.1 = 44.1 \\, m $$`, 
        "Usamos la f√≥rmula de posici√≥n.");

    html += `<div class="resultado-final">
        <p>Velocidad Inicial: <span class="res-valor">${format(v0)} m/s</span></p>
        <p>Altura M√°xima: <span class="res-valor">${format(h_max)} m</span></p>
    </div>`;

    document.getElementById('solucion-ej1').innerHTML = html;
    ej1Loaded = true;
    anim1.init();
}

/* --- EJERCICIO 2 --- */
let ej2Loaded = false;
function loadEj2() {
    if(ej2Loaded) { anim2.init(); return; }

    const H = 800, v0A = -80, v0B = 80, g = 9.8;
    const t = H / (Math.abs(v0A) + v0B); // 5s
    const h_enc = (v0B * t) - (0.5 * g * t*t);
    const vfA = v0A - g*t;
    const vfB = v0B - g*t;

    let html = createStep("Paso 1: Referencia", 
        `Pelota A (baja): $y_0=800, v_0=-80$. <br> Pelota B (sube): $y_0=0, v_0=+80$.`, 
        "El signo es vital: bajar es negativo, subir es positivo.");

    html += createStep("Paso 2: Tiempo de Encuentro", 
        `$$ y_A = y_B \\Rightarrow 800 - 80t - 4.9t^2 = 80t - 4.9t^2 $$
         $$ 800 = 160t \\Rightarrow t = 5 \\, s $$`, 
        "Igualamos posiciones. La gravedad se cancela.");

    html += createStep("Paso 3: Altura y Velocidades", 
        `Altura: $y_B = 80(5) - 4.9(25) = ${format(h_enc)} m$ <br>
         $v_A = -80 - 9.8(5) = ${format(vfA)} m/s$ <br>
         $v_B = 80 - 9.8(5) = ${format(vfB)} m/s$`, 
        "Sustituimos $t=5$ en las f√≥rmulas.");

    html += `<div class="resultado-final">
        <p>Tiempo: <span class="res-valor">5.00 s</span></p>
        <p>Altura: <span class="res-valor">${format(h_enc)} m</span></p>
    </div>`;

    document.getElementById('solucion-ej2').innerHTML = html;
    ej2Loaded = true;
    anim2.init();
}

/* --- EJERCICIO 3 --- */
let ej3Loaded = false;
function loadEj3() {
    if(ej3Loaded) { anim3.init(); return; }

    const a = 6, t1 = 20, g = 9.8;
    const h1 = 0.5 * a * t1*t1; // 1200
    const v1 = a * t1; // 120
    const t2 = v1 / g; // 12.24
    const h2 = (v1 * t2) - (0.5 * g * t2*t2); // 734.69
    const h_total = h1 + h2;
    const t3 = Math.sqrt((2*h_total)/g);
    const t_final = t1 + t2 + t3;

    let html = createStep("Fase 1: Motor (0-20s)", 
        `$h_1 = 0.5(6)(20^2) = ${format(h1)} m$ <br> $v_1 = 6(20) = ${format(v1)} m/s$`, 
        "Acelera hacia arriba.");

    html += createStep("Fase 2: Inercia", 
        `Sube hasta detenerse. <br> $t_{subida} = 120/9.8 = ${format(t2)} s$ <br> $h_{extra} = ${format(h2)} m$`, 
        "Motor apagado, la gravedad lo frena.");

    html += createStep("Fase 3: Ca√≠da y Totales", 
        `$H_{max} = 1200 + 734.7 = ${format(h_total)} m$ <br>
         Tiempo total = $20 + 12.24 + 19.87 = ${format(t_final)} s$`, 
        "Sumamos todas las etapas.");

    html += `<div class="resultado-final">
        <p>Altura M√°x: <span class="res-valor">${format(h_total)} m</span></p>
        <p>Tiempo Total: <span class="res-valor">${format(t_final)} s</span></p>
    </div>`;

    document.getElementById('solucion-ej3').innerHTML = html;
    ej3Loaded = true;
    anim3.init();
}

/* --- ANIMACIONES (CANVAS) --- */
const anim1 = {
    ctx: null, cvs: null, id: null, running: false, t: 0,
    init: function() {
        this.cvs = document.getElementById('canvas1');
        this.ctx = this.cvs.getContext('2d');
        this.resize();
        this.draw(0);
    },
    resize: function() {
        this.cvs.width = this.cvs.parentElement.clientWidth;
        this.cvs.height = 300;
    },
    toggle: function() { this.running ? this.stop() : this.start(); },
    start: function() { this.running = true; this.loop(); },
    stop: function() { this.running = false; cancelAnimationFrame(this.id); },
    reset: function() { this.stop(); this.t = 0; this.draw(0); },
    loop: function() {
        if(!this.running) return;
        this.t += 0.05;
        if(this.t > 6) { this.stop(); return; } // Auto stop
        this.draw(this.t);
        this.id = requestAnimationFrame(() => this.loop());
    },
    draw: function(time) {
        const w = this.cvs.width, h = this.cvs.height;
        this.ctx.clearRect(0,0,w,h);
        
        // F√≠sica: y = v0t - 0.5gt^2 (v0=29.4)
        let y_m = (29.4 * time) - (4.9 * time * time);
        if(y_m < 0) y_m = 0;
        
        // Escala: 45m -> 80% altura
        const scale = (h * 0.8) / 45;
        const y_px = h - 20 - (y_m * scale);

        // Suelo
        this.ctx.beginPath(); this.ctx.moveTo(0, h-20); this.ctx.lineTo(w, h-20); this.ctx.stroke();

        // Pelota
        this.ctx.beginPath();
        this.ctx.arc(w/2, y_px, 8, 0, Math.PI*2);
        this.ctx.fillStyle = '#1565C0'; this.ctx.fill();

        // Texto
        this.ctx.fillStyle = '#333';
        this.ctx.fillText(`t: ${time.toFixed(1)}s`, 10, 20);
        this.ctx.fillText(`h: ${y_m.toFixed(1)}m`, 10, 35);
    }
};

const anim2 = {
    ctx: null, cvs: null, id: null, running: false, t: 0,
    init: function() {
        this.cvs = document.getElementById('canvas2');
        this.ctx = this.cvs.getContext('2d');
        this.resize();
        this.draw(0);
    },
    resize: function() {
        this.cvs.width = this.cvs.parentElement.clientWidth;
        this.cvs.height = 300;
    },
    toggle: function() { this.running ? this.stop() : this.start(); },
    start: function() { this.running = true; this.loop(); },
    stop: function() { this.running = false; cancelAnimationFrame(this.id); },
    reset: function() { this.stop(); this.t = 0; this.draw(0); },
    loop: function() {
        if(!this.running) return;
        this.t += 0.05;
        if(this.t > 6) { this.stop(); return; }
        this.draw(this.t);
        this.id = requestAnimationFrame(() => this.loop());
    },
    draw: function(time) {
        const w = this.cvs.width, h = this.cvs.height;
        this.ctx.clearRect(0,0,w,h);
        
        // F√≠sica
        let yA = 800 - 80*time - 4.9*time*time;
        let yB = 80*time - 4.9*time*time;
        if(yA < 0) yA = 0; if(yB < 0) yB = 0;

        const scale = (h * 0.9) / 800;
        const yA_px = h - 10 - (yA * scale);
        const yB_px = h - 10 - (yB * scale);

        // Edificio
        this.ctx.fillStyle = '#CFD8DC';
        this.ctx.fillRect(20, h-10-(800*scale), 40, 800*scale);

        // Pelotas
        this.ctx.beginPath(); this.ctx.arc(w/2 - 20, yA_px, 6, 0, Math.PI*2);
        this.ctx.fillStyle = '#D32F2F'; this.ctx.fill(); // A (Roja)

        this.ctx.beginPath(); this.ctx.arc(w/2 + 20, yB_px, 6, 0, Math.PI*2);
        this.ctx.fillStyle = '#1976D2'; this.ctx.fill(); // B (Azul)

        // Cruce
        if(Math.abs(yA - yB) < 20) {
            this.ctx.fillStyle = '#FBC02D';
            this.ctx.fillText("¬°CRUCE!", w/2 - 20, yA_px - 10);
        }

        this.ctx.fillStyle = '#333';
        this.ctx.fillText(`t: ${time.toFixed(1)}s`, 10, 20);
    }
};

const anim3 = {
    ctx: null, cvs: null, id: null, running: false, t: 0,
    init: function() {
        this.cvs = document.getElementById('canvas3');
        this.ctx = this.cvs.getContext('2d');
        this.resize();
        this.draw(0);
    },
    resize: function() {
        this.cvs.width = this.cvs.parentElement.clientWidth;
        this.cvs.height = 350;
    },
    toggle: function() { this.running ? this.stop() : this.start(); },
    start: function() { this.running = true; this.loop(); },
    stop: function() { this.running = false; cancelAnimationFrame(this.id); },
    reset: function() { this.stop(); this.t = 0; this.draw(0); },
    loop: function() {
        if(!this.running) return;
        this.t += 0.1; // x5 speed (aprox)
        if(this.t > 55) { this.stop(); return; }
        this.draw(this.t);
        this.id = requestAnimationFrame(() => this.loop());
    },
    draw: function(time) {
        const w = this.cvs.width, h = this.cvs.height;
        this.ctx.clearRect(0,0,w,h);
        
        let y = 0, fase = "";
        if(time <= 20) {
            y = 0.5 * 6 * time*time;
            fase = "MOTOR ON";
        } else {
            let t2 = time - 20;
            y = 1200 + 120*t2 - 4.9*t2*t2;
            fase = (120 - 9.8*t2 > 0) ? "INERCIA" : "CA√çDA";
        }
        if(y < 0) { y = 0; fase = "SUELO"; }

        const scale = (h * 0.9) / 2000;
        const y_px = h - 20 - (y * scale);

        // Cohete
        this.ctx.save();
        this.ctx.translate(w/2, y_px);
        
        // Fuego
        if(fase === "MOTOR ON") {
            this.ctx.beginPath();
            this.ctx.moveTo(-5, 10); this.ctx.lineTo(0, 25 + Math.random()*10); this.ctx.lineTo(5, 10);
            this.ctx.fillStyle = 'orange'; this.ctx.fill();
        }

        this.ctx.fillStyle = '#546E7A';
        this.ctx.fillRect(-5, -10, 10, 20); // Cuerpo
        this.ctx.beginPath(); this.ctx.moveTo(-5,-10); this.ctx.lineTo(0,-20); this.ctx.lineTo(5,-10);
        this.ctx.fillStyle = 'red'; this.ctx.fill(); // Punta
        this.ctx.restore();

        // Info
        this.ctx.fillStyle = '#333';
        this.ctx.fillText(`t: ${time.toFixed(1)}s`, 10, 20);
        this.ctx.fillText(`h: ${y.toFixed(0)}m`, 10, 35);
        this.ctx.fillStyle = fase === "MOTOR ON" ? 'red' : 'blue';
        this.ctx.fillText(fase, 10, 55);
    }
};

// Inicializar
window.addEventListener('resize', () => {
    anim1.resize(); anim2.resize(); anim3.resize();
    if(!anim1.running) anim1.draw(anim1.t);
    if(!anim2.running) anim2.draw(anim2.t);
    if(!anim3.running) anim3.draw(anim3.t);
});
</script>

</body>
</html>